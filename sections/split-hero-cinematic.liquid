{% schema %}
{
  "name": "Cinematic Split Hero",
  "tag": "section",
  "class": "section-split-hero",
  "max_blocks": 2,
  "settings": [
    {
      "type": "select",
      "id": "height",
      "label": "Section Height",
      "options": [
        { "value": "50vh", "label": "Small (50vh)" },
        { "value": "75vh", "label": "Medium (75vh)" },
        { "value": "100vh", "label": "Full Screen (100vh)" }
      ],
      "default": "100vh"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    }
  ],
  "blocks": [
    {
      "type": "split_column",
      "name": "Split Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "video",
          "id": "video",
          "label": "Background Video (Optional)"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Shop Category"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "min": 0,
          "max": 90,
          "step": 10,
          "unit": "%",
          "label": "Overlay Opacity",
          "default": 20
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Cinematic Split Hero",
      "blocks": [
        {
          "type": "split_column",
          "settings": {
            "heading": "New Arrivals"
          }
        },
        {
          "type": "split_column",
          "settings": {
            "heading": "Best Sellers"
          }
        }
      ]
    }
  ]
}
{% endschema %}

{%- style -%}
  .split-hero {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: var(--section-height, 100vh);
    overflow: hidden;
  }

  @media screen and (min-width: 768px) {
    .split-hero {
      flex-direction: row;
    }
  }

  .split-item {
    position: relative;
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    transition: flex 0.6s cubic-bezier(0.16, 1, 0.3, 1);
    text-decoration: none;
    color: #fff;
    min-height: 50vh; /* Mobile fallback */
  }

  @media screen and (min-width: 768px) {
    .split-item {
      min-height: auto;
    }

    /* Magnetic Hover Effect */
    .split-hero:hover .split-item {
      flex: 1; /* Reset */
    }

    .split-hero:hover .split-item:hover {
      flex: 1.5; /* Expand hovered item */
    }

    /* Optional: Dim non-hovered items */
    .split-hero:hover .split-item:not(:hover) .split-overlay {
      background: rgba(0, 0, 0, 0.5);
    }
  }

  .split-bg-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
  }

  .split-bg {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.8s ease;
  }

  .split-item:hover .split-bg {
    transform: scale(1.05);
  }

  .split-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    opacity: 0.3;
    z-index: 1;
    transition: background 0.4s ease;
  }

  .split-content {
    position: relative;
    z-index: 2;
    text-align: center;
    padding: 2rem;
    pointer-events: none; /* Let clicks pass through if needed, but anchor wraps div */
  }

  .split-heading {
    font-size: clamp(2.5rem, 5vw, 4rem);
    text-transform: uppercase;
    font-weight: 300;
    letter-spacing: -0.02em;
    margin: 0;
    opacity: 0.9;
    transform: translateY(0);
    transition: all 0.5s ease;
  }

  .split-item:hover .split-heading {
    opacity: 1;
    transform: scale(1.05);
  }

  .split-link-icon {
    display: inline-block;
    margin-top: 1rem;
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.4s ease;
  }

  .split-item:hover .split-link-icon {
    opacity: 1;
    transform: translateY(0);
  }
{%- endstyle -%}

<div
  class="split-hero color-{{ section.settings.color_scheme }}"
  style="--section-height: {{ section.settings.height }};"
>
  {%- for block in section.blocks -%}
    <a href="{{ block.settings.link }}" class="split-item" {{ block.shopify_attributes }}>
      <div class="split-bg-wrapper">
        {%- if block.settings.video != blank -%}
          {{
            block.settings.video
            | video_tag: autoplay: true, loop: true, muted: true, controls: false, class: 'split-bg'
          }}
        {%- elsif block.settings.image != blank -%}
          {{ block.settings.image | image_url: width: 2000 | image_tag: class: 'split-bg', loading: 'lazy' }}
        {%- else -%}
          {{ 'lifestyle-' | append: forloop.index | placeholder_svg_tag: 'split-bg placeholder-svg' }}
        {%- endif -%}
      </div>

      <div class="split-overlay" style="opacity: {{ block.settings.overlay_opacity | divided_by: 100.0 }}"></div>

      <div class="split-content">
        <h2 class="split-heading">{{ block.settings.heading }}</h2>
        <span class="split-link-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
      </div>
    </a>
  {%- endfor -%}
</div>
